<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 Non-Identifiability in Mixture Models: An Example | Generative Modeling Workshop</title>
  <meta name="description" content="6 Non-Identifiability in Mixture Models: An Example | Generative Modeling Workshop" />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="6 Non-Identifiability in Mixture Models: An Example | Generative Modeling Workshop" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Non-Identifiability in Mixture Models: An Example | Generative Modeling Workshop" />
  
  
  

<meta name="author" content="Susan Holmes" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="labs-and-challenges.html"/>
<link rel="next" href="intervention.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Index</a></li>
<li class="chapter" data-level="2" data-path="workshop-on-using-generative-models.html"><a href="workshop-on-using-generative-models.html"><i class="fa fa-check"></i><b>2</b> Workshop on using generative models</a>
<ul>
<li class="chapter" data-level="2.1" data-path="workshop-on-using-generative-models.html"><a href="workshop-on-using-generative-models.html#our-learning-goals"><i class="fa fa-check"></i><b>2.1</b> Our learning goals:</a></li>
<li class="chapter" data-level="2.2" data-path="workshop-on-using-generative-models.html"><a href="workshop-on-using-generative-models.html#prerequisites"><i class="fa fa-check"></i><b>2.2</b> Prerequisites:</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="beyond-black-box-simulation.html"><a href="beyond-black-box-simulation.html"><i class="fa fa-check"></i><b>3</b> Beyond Black Box Simulation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="beyond-black-box-simulation.html"><a href="beyond-black-box-simulation.html#new-lingua-franca-of-science"><i class="fa fa-check"></i><b>3.1</b> New Lingua Franca of Science</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="beyond-black-box-simulation.html"><a href="beyond-black-box-simulation.html#new-lingua-franca-of-science-1"><i class="fa fa-check"></i><b>3.1.1</b> New Lingua Franca of Science</a></li>
<li class="chapter" data-level="3.1.2" data-path="beyond-black-box-simulation.html"><a href="beyond-black-box-simulation.html#grammar-of-generative-models"><i class="fa fa-check"></i><b>3.1.2</b> Grammar of Generative Models</a></li>
<li class="chapter" data-level="3.1.3" data-path="beyond-black-box-simulation.html"><a href="beyond-black-box-simulation.html#discrepancy-and-iterability"><i class="fa fa-check"></i><b>3.1.3</b> Discrepancy and Iterability</a></li>
<li class="chapter" data-level="3.1.4" data-path="beyond-black-box-simulation.html"><a href="beyond-black-box-simulation.html#experimental-design-renaissance"><i class="fa fa-check"></i><b>3.1.4</b> Experimental Design Renaissance</a></li>
<li class="chapter" data-level="3.1.5" data-path="beyond-black-box-simulation.html"><a href="beyond-black-box-simulation.html#simulation-to-the-rescue"><i class="fa fa-check"></i><b>3.1.5</b> Simulation to the Rescue</a></li>
<li class="chapter" data-level="3.1.6" data-path="beyond-black-box-simulation.html"><a href="beyond-black-box-simulation.html#covasim"><i class="fa fa-check"></i><b>3.1.6</b> Covasim</a></li>
<li class="chapter" data-level="3.1.7" data-path="beyond-black-box-simulation.html"><a href="beyond-black-box-simulation.html#covasim-1"><i class="fa fa-check"></i><b>3.1.7</b> Covasim</a></li>
<li class="chapter" data-level="3.1.8" data-path="beyond-black-box-simulation.html"><a href="beyond-black-box-simulation.html#what-are-we-going-to-study"><i class="fa fa-check"></i><b>3.1.8</b> What are we going to study ?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="slides.html"><a href="slides.html"><i class="fa fa-check"></i><b>4</b> Slides</a></li>
<li class="chapter" data-level="5" data-path="labs-and-challenges.html"><a href="labs-and-challenges.html"><i class="fa fa-check"></i><b>5</b> Labs and Challenges :</a></li>
<li class="chapter" data-level="6" data-path="non-identifiability-in-mixture-models-an-example.html"><a href="non-identifiability-in-mixture-models-an-example.html"><i class="fa fa-check"></i><b>6</b> Non-Identifiability in Mixture Models: An Example</a>
<ul>
<li class="chapter" data-level="6.1" data-path="non-identifiability-in-mixture-models-an-example.html"><a href="non-identifiability-in-mixture-models-an-example.html#introduction-to-non-identifiability"><i class="fa fa-check"></i><b>6.1</b> Introduction to Non-Identifiability</a></li>
<li class="chapter" data-level="6.2" data-path="non-identifiability-in-mixture-models-an-example.html"><a href="non-identifiability-in-mixture-models-an-example.html#the-binomial-mixture-model"><i class="fa fa-check"></i><b>6.2</b> The Binomial Mixture Model</a></li>
<li class="chapter" data-level="6.3" data-path="non-identifiability-in-mixture-models-an-example.html"><a href="non-identifiability-in-mixture-models-an-example.html#simulating-data-from-mixture-models"><i class="fa fa-check"></i><b>6.3</b> Simulating Data from Mixture Models</a></li>
<li class="chapter" data-level="6.4" data-path="non-identifiability-in-mixture-models-an-example.html"><a href="non-identifiability-in-mixture-models-an-example.html#demonstrating-non-identifiability"><i class="fa fa-check"></i><b>6.4</b> Demonstrating Non-Identifiability</a></li>
<li class="chapter" data-level="6.5" data-path="non-identifiability-in-mixture-models-an-example.html"><a href="non-identifiability-in-mixture-models-an-example.html#comparing-distributions-directly"><i class="fa fa-check"></i><b>6.5</b> Comparing Distributions Directly</a></li>
<li class="chapter" data-level="6.6" data-path="non-identifiability-in-mixture-models-an-example.html"><a href="non-identifiability-in-mixture-models-an-example.html#exploring-parameter-space"><i class="fa fa-check"></i><b>6.6</b> Exploring Parameter Space</a></li>
<li class="chapter" data-level="6.7" data-path="non-identifiability-in-mixture-models-an-example.html"><a href="non-identifiability-in-mixture-models-an-example.html#practical-implications-for-inference"><i class="fa fa-check"></i><b>6.7</b> Practical Implications for Inference</a></li>
<li class="chapter" data-level="6.8" data-path="non-identifiability-in-mixture-models-an-example.html"><a href="non-identifiability-in-mixture-models-an-example.html#non-identifiability-as-a-function-of-separation"><i class="fa fa-check"></i><b>6.8</b> Non-Identifiability as a Function of Separation</a></li>
<li class="chapter" data-level="6.9" data-path="non-identifiability-in-mixture-models-an-example.html"><a href="non-identifiability-in-mixture-models-an-example.html#visualizing-the-non-identifiability-region"><i class="fa fa-check"></i><b>6.9</b> Visualizing the Non-Identifiability Region</a></li>
<li class="chapter" data-level="6.10" data-path="non-identifiability-in-mixture-models-an-example.html"><a href="non-identifiability-in-mixture-models-an-example.html#the-likelihood-surface"><i class="fa fa-check"></i><b>6.10</b> The Likelihood Surface</a></li>
<li class="chapter" data-level="6.11" data-path="non-identifiability-in-mixture-models-an-example.html"><a href="non-identifiability-in-mixture-models-an-example.html#practical-implications-and-solutions"><i class="fa fa-check"></i><b>6.11</b> Practical Implications and Solutions</a></li>
<li class="chapter" data-level="6.12" data-path="non-identifiability-in-mixture-models-an-example.html"><a href="non-identifiability-in-mixture-models-an-example.html#conclusion"><i class="fa fa-check"></i><b>6.12</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="intervention.html"><a href="intervention.html"><i class="fa fa-check"></i><b>7</b> Intervention</a>
<ul>
<li class="chapter" data-level="7.1" data-path="intervention.html"><a href="intervention.html#start-defining-the-intervention-in-a-time-series"><i class="fa fa-check"></i><b>7.1</b> Start defining the intervention in a time series</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="intervention_optimize.html"><a href="intervention_optimize.html"><i class="fa fa-check"></i><b>8</b> Intervention_Optimize</a></li>
<li class="chapter" data-level="9" data-path="heteroskedastic-mixtures-goodness-of-fit-iterations.html"><a href="heteroskedastic-mixtures-goodness-of-fit-iterations.html"><i class="fa fa-check"></i><b>9</b> Heteroskedastic Mixtures : goodness of fit iterations</a></li>
<li class="chapter" data-level="10" data-path="stan-explained.html"><a href="stan-explained.html"><i class="fa fa-check"></i><b>10</b> Stan Explained</a>
<ul>
<li class="chapter" data-level="10.1" data-path="stan-explained.html"><a href="stan-explained.html#installing-stan"><i class="fa fa-check"></i><b>10.1</b> Installing <code>stan</code></a></li>
<li class="chapter" data-level="10.2" data-path="stan-explained.html"><a href="stan-explained.html#gmm.stan-file"><i class="fa fa-check"></i><b>10.2</b> <code>gmm.stan</code> file</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="stan-explained.html"><a href="stan-explained.html#in-plain-english"><i class="fa fa-check"></i><b>10.2.1</b> In plain English</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="stan-explained.html"><a href="stan-explained.html#more-examples"><i class="fa fa-check"></i><b>10.3</b> More examples</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="likelihood-free-inference-via-classification.html"><a href="likelihood-free-inference-via-classification.html"><i class="fa fa-check"></i><b>11</b> Likelihood-Free Inference via Classification</a>
<ul>
<li class="chapter" data-level="11.1" data-path="likelihood-free-inference-via-classification.html"><a href="likelihood-free-inference-via-classification.html#motivation"><i class="fa fa-check"></i><b>11.1</b> Motivation</a></li>
<li class="chapter" data-level="11.2" data-path="likelihood-free-inference-via-classification.html"><a href="likelihood-free-inference-via-classification.html#likelihood-free-inference-the-big-picture"><i class="fa fa-check"></i><b>11.2</b> Likelihood-Free Inference: The Big Picture</a></li>
<li class="chapter" data-level="11.3" data-path="likelihood-free-inference-via-classification.html"><a href="likelihood-free-inference-via-classification.html#what-is-abc"><i class="fa fa-check"></i><b>11.3</b> What is ABC?</a></li>
<li class="chapter" data-level="11.4" data-path="likelihood-free-inference-via-classification.html"><a href="likelihood-free-inference-via-classification.html#when-to-use-abc"><i class="fa fa-check"></i><b>11.4</b> When to Use ABC</a></li>
<li class="chapter" data-level="11.5" data-path="likelihood-free-inference-via-classification.html"><a href="likelihood-free-inference-via-classification.html#the-abc-rejection-algorithm"><i class="fa fa-check"></i><b>11.5</b> The ABC Rejection Algorithm</a></li>
<li class="chapter" data-level="11.6" data-path="likelihood-free-inference-via-classification.html"><a href="likelihood-free-inference-via-classification.html#illustrated-example-estimating-a-mean"><i class="fa fa-check"></i><b>11.6</b> Illustrated Example: Estimating a Mean</a></li>
<li class="chapter" data-level="11.7" data-path="likelihood-free-inference-via-classification.html"><a href="likelihood-free-inference-via-classification.html#acceptance-threshold-visualization"><i class="fa fa-check"></i><b>11.7</b> Acceptance Threshold Visualization</a></li>
<li class="chapter" data-level="11.8" data-path="likelihood-free-inference-via-classification.html"><a href="likelihood-free-inference-via-classification.html#abc-approximate-posterior"><i class="fa fa-check"></i><b>11.8</b> ABC Approximate Posterior</a></li>
<li class="chapter" data-level="11.9" data-path="likelihood-free-inference-via-classification.html"><a href="likelihood-free-inference-via-classification.html#extensions-of-abc"><i class="fa fa-check"></i><b>11.9</b> Extensions of ABC</a></li>
<li class="chapter" data-level="11.10" data-path="likelihood-free-inference-via-classification.html"><a href="likelihood-free-inference-via-classification.html#references-about-abc"><i class="fa fa-check"></i><b>11.10</b> References about ABC</a></li>
<li class="chapter" data-level="11.11" data-path="likelihood-free-inference-via-classification.html"><a href="likelihood-free-inference-via-classification.html#classification-based-lfi"><i class="fa fa-check"></i><b>11.11</b> Classification-Based LFI</a></li>
<li class="chapter" data-level="11.12" data-path="likelihood-free-inference-via-classification.html"><a href="likelihood-free-inference-via-classification.html#algorithm-sketch"><i class="fa fa-check"></i><b>11.12</b> Algorithm Sketch</a></li>
<li class="chapter" data-level="11.13" data-path="likelihood-free-inference-via-classification.html"><a href="likelihood-free-inference-via-classification.html#motivation-1"><i class="fa fa-check"></i><b>11.13</b> Motivation</a></li>
<li class="chapter" data-level="11.14" data-path="likelihood-free-inference-via-classification.html"><a href="likelihood-free-inference-via-classification.html#likelihood-free-inference-the-big-picture-1"><i class="fa fa-check"></i><b>11.14</b> Likelihood-Free Inference: The Big Picture</a></li>
<li class="chapter" data-level="11.15" data-path="likelihood-free-inference-via-classification.html"><a href="likelihood-free-inference-via-classification.html#classification-based-lfi-1"><i class="fa fa-check"></i><b>11.15</b> Classification-Based LFI</a></li>
<li class="chapter" data-level="11.16" data-path="likelihood-free-inference-via-classification.html"><a href="likelihood-free-inference-via-classification.html#algorithm-sketch-1"><i class="fa fa-check"></i><b>11.16</b> Algorithm Sketch</a></li>
<li class="chapter" data-level="11.17" data-path="likelihood-free-inference-via-classification.html"><a href="likelihood-free-inference-via-classification.html#example-1d-gaussian-mixture"><i class="fa fa-check"></i><b>11.17</b> Example: 1D Gaussian Mixture</a>
<ul>
<li class="chapter" data-level="11.17.1" data-path="likelihood-free-inference-via-classification.html"><a href="likelihood-free-inference-via-classification.html#example-logistic-discriminator"><i class="fa fa-check"></i><b>11.17.1</b> Example: Logistic Discriminator</a></li>
</ul></li>
<li class="chapter" data-level="11.18" data-path="likelihood-free-inference-via-classification.html"><a href="likelihood-free-inference-via-classification.html#applications-case-studies"><i class="fa fa-check"></i><b>11.18</b> Applications &amp; Case Studies</a></li>
<li class="chapter" data-level="11.19" data-path="likelihood-free-inference-via-classification.html"><a href="likelihood-free-inference-via-classification.html#practical-tips"><i class="fa fa-check"></i><b>11.19</b> Practical Tips</a></li>
<li class="chapter" data-level="11.20" data-path="likelihood-free-inference-via-classification.html"><a href="likelihood-free-inference-via-classification.html#advantages-limitations"><i class="fa fa-check"></i><b>11.20</b> Advantages &amp; Limitations</a></li>
<li class="chapter" data-level="11.21" data-path="likelihood-free-inference-via-classification.html"><a href="likelihood-free-inference-via-classification.html#summary-outlook"><i class="fa fa-check"></i><b>11.21</b> Summary &amp; Outlook</a></li>
<li class="chapter" data-level="11.22" data-path="likelihood-free-inference-via-classification.html"><a href="likelihood-free-inference-via-classification.html#references"><i class="fa fa-check"></i><b>11.22</b> References</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="all-the-tools-already-available.html"><a href="all-the-tools-already-available.html"><i class="fa fa-check"></i><b>12</b> All the tools already available</a>
<ul>
<li class="chapter" data-level="12.1" data-path="all-the-tools-already-available.html"><a href="all-the-tools-already-available.html#a-cran-view-of-what-exists"><i class="fa fa-check"></i><b>12.1</b> A CRAN view of what exists:</a></li>
<li class="chapter" data-level="12.2" data-path="all-the-tools-already-available.html"><a href="all-the-tools-already-available.html#specific-packages"><i class="fa fa-check"></i><b>12.2</b> Specific Packages:</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="multimodal-data-examples-of-approaches.html"><a href="multimodal-data-examples-of-approaches.html"><i class="fa fa-check"></i><b>13</b> Multimodal data examples of approaches</a>
<ul>
<li class="chapter" data-level="13.1" data-path="multimodal-data-examples-of-approaches.html"><a href="multimodal-data-examples-of-approaches.html#special-data-structures"><i class="fa fa-check"></i><b>13.1</b> Special data structures</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="other-examples-of-applications.html"><a href="other-examples-of-applications.html"><i class="fa fa-check"></i><b>14</b> Other examples of applications</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Generative Modeling Workshop</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="non-identifiability-in-mixture-models-an-example" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">6</span> Non-Identifiability in Mixture Models: An Example<a href="non-identifiability-in-mixture-models-an-example.html#non-identifiability-in-mixture-models-an-example" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introduction-to-non-identifiability" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Introduction to Non-Identifiability<a href="non-identifiability-in-mixture-models-an-example.html#introduction-to-non-identifiability" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Non-identifiability occurs when multiple different parameter values lead to identical (or nearly identical) probability distributions. In such cases, it becomes challenging or impossible to determine the true parameters from observed data, as different parameter combinations can explain the same observations equally well.</p>
<p>This tutorial demonstrates this concept using a <strong>mixture of two binomial distributions</strong>. We’ll show how different combinations of mixture proportions and probability parameters can generate virtually indistinguishable data.</p>
</div>
<div id="the-binomial-mixture-model" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> The Binomial Mixture Model<a href="non-identifiability-in-mixture-models-an-example.html#the-binomial-mixture-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Consider a mixture of two binomial distributions with the following parameters:
- Mixture proportion: <span class="math inline">\(\alpha\)</span> and <span class="math inline">\((1-\alpha)\)</span>
- Success probabilities: <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2\)</span>
- Number of trials: <span class="math inline">\(n\)</span></p>
<p>The probability mass function is:
<span class="math display">\[P(X=k) = \alpha \binom{n}{k} p_1^k (1-p_1)^{n-k} + (1-\alpha) \binom{n}{k} p_2^k (1-p_2)^{n-k}\]</span></p>
</div>
<div id="simulating-data-from-mixture-models" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Simulating Data from Mixture Models<a href="non-identifiability-in-mixture-models-an-example.html#simulating-data-from-mixture-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>First, let’s create a function that generates data from a mixture of two binomial distributions:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="non-identifiability-in-mixture-models-an-example.html#cb2-1" tabindex="-1"></a><span class="co"># Function to generate data from a mixture of two binomials</span></span>
<span id="cb2-2"><a href="non-identifiability-in-mixture-models-an-example.html#cb2-2" tabindex="-1"></a>generate_binomial_mixture <span class="ot">&lt;-</span> <span class="cf">function</span>(n_samples, n_trials, alpha, p1, p2) {</span>
<span id="cb2-3"><a href="non-identifiability-in-mixture-models-an-example.html#cb2-3" tabindex="-1"></a>  <span class="co"># Determine which component each sample comes from</span></span>
<span id="cb2-4"><a href="non-identifiability-in-mixture-models-an-example.html#cb2-4" tabindex="-1"></a>  component <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n_samples, <span class="dv">1</span>, alpha)</span>
<span id="cb2-5"><a href="non-identifiability-in-mixture-models-an-example.html#cb2-5" tabindex="-1"></a>  </span>
<span id="cb2-6"><a href="non-identifiability-in-mixture-models-an-example.html#cb2-6" tabindex="-1"></a>  <span class="co"># Generate binomial observations</span></span>
<span id="cb2-7"><a href="non-identifiability-in-mixture-models-an-example.html#cb2-7" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_samples)</span>
<span id="cb2-8"><a href="non-identifiability-in-mixture-models-an-example.html#cb2-8" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_samples) {</span>
<span id="cb2-9"><a href="non-identifiability-in-mixture-models-an-example.html#cb2-9" tabindex="-1"></a>    <span class="cf">if</span> (component[i] <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb2-10"><a href="non-identifiability-in-mixture-models-an-example.html#cb2-10" tabindex="-1"></a>      samples[i] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n_trials, p1)</span>
<span id="cb2-11"><a href="non-identifiability-in-mixture-models-an-example.html#cb2-11" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb2-12"><a href="non-identifiability-in-mixture-models-an-example.html#cb2-12" tabindex="-1"></a>      samples[i] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n_trials, p2)</span>
<span id="cb2-13"><a href="non-identifiability-in-mixture-models-an-example.html#cb2-13" tabindex="-1"></a>    }</span>
<span id="cb2-14"><a href="non-identifiability-in-mixture-models-an-example.html#cb2-14" tabindex="-1"></a>  }</span>
<span id="cb2-15"><a href="non-identifiability-in-mixture-models-an-example.html#cb2-15" tabindex="-1"></a>  </span>
<span id="cb2-16"><a href="non-identifiability-in-mixture-models-an-example.html#cb2-16" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb2-17"><a href="non-identifiability-in-mixture-models-an-example.html#cb2-17" tabindex="-1"></a>    <span class="at">samples =</span> samples,</span>
<span id="cb2-18"><a href="non-identifiability-in-mixture-models-an-example.html#cb2-18" tabindex="-1"></a>    <span class="at">component =</span> component,</span>
<span id="cb2-19"><a href="non-identifiability-in-mixture-models-an-example.html#cb2-19" tabindex="-1"></a>    <span class="at">parameters =</span> <span class="fu">list</span>(<span class="at">alpha =</span> alpha, <span class="at">p1 =</span> p1, <span class="at">p2 =</span> p2, <span class="at">n_trials =</span> n_trials)</span>
<span id="cb2-20"><a href="non-identifiability-in-mixture-models-an-example.html#cb2-20" tabindex="-1"></a>  ))</span>
<span id="cb2-21"><a href="non-identifiability-in-mixture-models-an-example.html#cb2-21" tabindex="-1"></a>}</span></code></pre></div>
<p>Let’s also define a function to plot the frequency distribution of our data:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="non-identifiability-in-mixture-models-an-example.html#cb3-1" tabindex="-1"></a><span class="co"># Function to plot the histogram of a binomial mixture</span></span>
<span id="cb3-2"><a href="non-identifiability-in-mixture-models-an-example.html#cb3-2" tabindex="-1"></a>plot_binomial_mixture <span class="ot">&lt;-</span> <span class="cf">function</span>(data, title) {</span>
<span id="cb3-3"><a href="non-identifiability-in-mixture-models-an-example.html#cb3-3" tabindex="-1"></a>  <span class="co"># Convert to data frame for ggplot</span></span>
<span id="cb3-4"><a href="non-identifiability-in-mixture-models-an-example.html#cb3-4" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">value =</span> data<span class="sc">$</span>samples)</span>
<span id="cb3-5"><a href="non-identifiability-in-mixture-models-an-example.html#cb3-5" tabindex="-1"></a>  </span>
<span id="cb3-6"><a href="non-identifiability-in-mixture-models-an-example.html#cb3-6" tabindex="-1"></a>  <span class="co"># Extract parameters for the title</span></span>
<span id="cb3-7"><a href="non-identifiability-in-mixture-models-an-example.html#cb3-7" tabindex="-1"></a>  params <span class="ot">&lt;-</span> data<span class="sc">$</span>parameters</span>
<span id="cb3-8"><a href="non-identifiability-in-mixture-models-an-example.html#cb3-8" tabindex="-1"></a>  subtitle <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">&quot;α = %.2f, p₁ = %.2f, p₂ = %.2f, n = %d&quot;</span>, </span>
<span id="cb3-9"><a href="non-identifiability-in-mixture-models-an-example.html#cb3-9" tabindex="-1"></a>                     params<span class="sc">$</span>alpha, params<span class="sc">$</span>p1, params<span class="sc">$</span>p2, params<span class="sc">$</span>n_trials)</span>
<span id="cb3-10"><a href="non-identifiability-in-mixture-models-an-example.html#cb3-10" tabindex="-1"></a>  </span>
<span id="cb3-11"><a href="non-identifiability-in-mixture-models-an-example.html#cb3-11" tabindex="-1"></a>  <span class="co"># Calculate PMF for theoretical overlay</span></span>
<span id="cb3-12"><a href="non-identifiability-in-mixture-models-an-example.html#cb3-12" tabindex="-1"></a>  x_values <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span>params<span class="sc">$</span>n_trials</span>
<span id="cb3-13"><a href="non-identifiability-in-mixture-models-an-example.html#cb3-13" tabindex="-1"></a>  pmf_values <span class="ot">&lt;-</span> params<span class="sc">$</span>alpha <span class="sc">*</span> <span class="fu">dbinom</span>(x_values, params<span class="sc">$</span>n_trials, params<span class="sc">$</span>p1) <span class="sc">+</span> </span>
<span id="cb3-14"><a href="non-identifiability-in-mixture-models-an-example.html#cb3-14" tabindex="-1"></a>               (<span class="dv">1</span> <span class="sc">-</span> params<span class="sc">$</span>alpha) <span class="sc">*</span> <span class="fu">dbinom</span>(x_values, params<span class="sc">$</span>n_trials, params<span class="sc">$</span>p2)</span>
<span id="cb3-15"><a href="non-identifiability-in-mixture-models-an-example.html#cb3-15" tabindex="-1"></a>  </span>
<span id="cb3-16"><a href="non-identifiability-in-mixture-models-an-example.html#cb3-16" tabindex="-1"></a>  theoretical_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb3-17"><a href="non-identifiability-in-mixture-models-an-example.html#cb3-17" tabindex="-1"></a>    <span class="at">x =</span> x_values,</span>
<span id="cb3-18"><a href="non-identifiability-in-mixture-models-an-example.html#cb3-18" tabindex="-1"></a>    <span class="at">density =</span> pmf_values</span>
<span id="cb3-19"><a href="non-identifiability-in-mixture-models-an-example.html#cb3-19" tabindex="-1"></a>  )</span>
<span id="cb3-20"><a href="non-identifiability-in-mixture-models-an-example.html#cb3-20" tabindex="-1"></a>  </span>
<span id="cb3-21"><a href="non-identifiability-in-mixture-models-an-example.html#cb3-21" tabindex="-1"></a>  <span class="co"># Create histogram with theoretical overlay</span></span>
<span id="cb3-22"><a href="non-identifiability-in-mixture-models-an-example.html#cb3-22" tabindex="-1"></a>  <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb3-23"><a href="non-identifiability-in-mixture-models-an-example.html#cb3-23" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density)), <span class="at">bins =</span> params<span class="sc">$</span>n_trials <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb3-24"><a href="non-identifiability-in-mixture-models-an-example.html#cb3-24" tabindex="-1"></a>                   <span class="at">fill =</span> <span class="st">&quot;skyblue&quot;</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb3-25"><a href="non-identifiability-in-mixture-models-an-example.html#cb3-25" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">data =</span> theoretical_df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> density), </span>
<span id="cb3-26"><a href="non-identifiability-in-mixture-models-an-example.html#cb3-26" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb3-27"><a href="non-identifiability-in-mixture-models-an-example.html#cb3-27" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> theoretical_df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> density), </span>
<span id="cb3-28"><a href="non-identifiability-in-mixture-models-an-example.html#cb3-28" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb3-29"><a href="non-identifiability-in-mixture-models-an-example.html#cb3-29" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> title,</span>
<span id="cb3-30"><a href="non-identifiability-in-mixture-models-an-example.html#cb3-30" tabindex="-1"></a>         <span class="at">subtitle =</span> subtitle,</span>
<span id="cb3-31"><a href="non-identifiability-in-mixture-models-an-example.html#cb3-31" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Number of Successes&quot;</span>,</span>
<span id="cb3-32"><a href="non-identifiability-in-mixture-models-an-example.html#cb3-32" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb3-33"><a href="non-identifiability-in-mixture-models-an-example.html#cb3-33" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb3-34"><a href="non-identifiability-in-mixture-models-an-example.html#cb3-34" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb3-35"><a href="non-identifiability-in-mixture-models-an-example.html#cb3-35" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb3-36"><a href="non-identifiability-in-mixture-models-an-example.html#cb3-36" tabindex="-1"></a>      <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb3-37"><a href="non-identifiability-in-mixture-models-an-example.html#cb3-37" tabindex="-1"></a>      <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb3-38"><a href="non-identifiability-in-mixture-models-an-example.html#cb3-38" tabindex="-1"></a>      <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>)</span>
<span id="cb3-39"><a href="non-identifiability-in-mixture-models-an-example.html#cb3-39" tabindex="-1"></a>    )</span>
<span id="cb3-40"><a href="non-identifiability-in-mixture-models-an-example.html#cb3-40" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="demonstrating-non-identifiability" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Demonstrating Non-Identifiability<a href="non-identifiability-in-mixture-models-an-example.html#demonstrating-non-identifiability" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now, let’s create two different parameter sets that generate similar data distributions:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="non-identifiability-in-mixture-models-an-example.html#cb4-1" tabindex="-1"></a><span class="co"># Set parameters for our two models</span></span>
<span id="cb4-2"><a href="non-identifiability-in-mixture-models-an-example.html#cb4-2" tabindex="-1"></a>n_samples <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb4-3"><a href="non-identifiability-in-mixture-models-an-example.html#cb4-3" tabindex="-1"></a>n_trials <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb4-4"><a href="non-identifiability-in-mixture-models-an-example.html#cb4-4" tabindex="-1"></a></span>
<span id="cb4-5"><a href="non-identifiability-in-mixture-models-an-example.html#cb4-5" tabindex="-1"></a><span class="co"># Parameter Set 1</span></span>
<span id="cb4-6"><a href="non-identifiability-in-mixture-models-an-example.html#cb4-6" tabindex="-1"></a>alpha1 <span class="ot">&lt;-</span> <span class="fl">0.7</span></span>
<span id="cb4-7"><a href="non-identifiability-in-mixture-models-an-example.html#cb4-7" tabindex="-1"></a>p1_1 <span class="ot">&lt;-</span> <span class="fl">0.3</span></span>
<span id="cb4-8"><a href="non-identifiability-in-mixture-models-an-example.html#cb4-8" tabindex="-1"></a>p2_1 <span class="ot">&lt;-</span> <span class="fl">0.8</span></span>
<span id="cb4-9"><a href="non-identifiability-in-mixture-models-an-example.html#cb4-9" tabindex="-1"></a></span>
<span id="cb4-10"><a href="non-identifiability-in-mixture-models-an-example.html#cb4-10" tabindex="-1"></a><span class="co"># Parameter Set 2 (different parameters but similar distribution)</span></span>
<span id="cb4-11"><a href="non-identifiability-in-mixture-models-an-example.html#cb4-11" tabindex="-1"></a>alpha2 <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb4-12"><a href="non-identifiability-in-mixture-models-an-example.html#cb4-12" tabindex="-1"></a>p1_2 <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb4-13"><a href="non-identifiability-in-mixture-models-an-example.html#cb4-13" tabindex="-1"></a>p2_2 <span class="ot">&lt;-</span> <span class="fl">0.7</span></span>
<span id="cb4-14"><a href="non-identifiability-in-mixture-models-an-example.html#cb4-14" tabindex="-1"></a></span>
<span id="cb4-15"><a href="non-identifiability-in-mixture-models-an-example.html#cb4-15" tabindex="-1"></a><span class="co"># Generate data from both models</span></span>
<span id="cb4-16"><a href="non-identifiability-in-mixture-models-an-example.html#cb4-16" tabindex="-1"></a>data1 <span class="ot">&lt;-</span> <span class="fu">generate_binomial_mixture</span>(n_samples, n_trials, alpha1, p1_1, p2_1)</span>
<span id="cb4-17"><a href="non-identifiability-in-mixture-models-an-example.html#cb4-17" tabindex="-1"></a>data2 <span class="ot">&lt;-</span> <span class="fu">generate_binomial_mixture</span>(n_samples, n_trials, alpha2, p1_2, p2_2)</span>
<span id="cb4-18"><a href="non-identifiability-in-mixture-models-an-example.html#cb4-18" tabindex="-1"></a></span>
<span id="cb4-19"><a href="non-identifiability-in-mixture-models-an-example.html#cb4-19" tabindex="-1"></a><span class="co"># Plot histograms of both datasets</span></span>
<span id="cb4-20"><a href="non-identifiability-in-mixture-models-an-example.html#cb4-20" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> <span class="fu">plot_binomial_mixture</span>(data1, <span class="st">&quot;Binomial Mixture - Parameter Set 1&quot;</span>)</span>
<span id="cb4-21"><a href="non-identifiability-in-mixture-models-an-example.html#cb4-21" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> <span class="fu">plot_binomial_mixture</span>(data2, <span class="st">&quot;Binomial Mixture - Parameter Set 2&quot;</span>)</span>
<span id="cb4-22"><a href="non-identifiability-in-mixture-models-an-example.html#cb4-22" tabindex="-1"></a></span>
<span id="cb4-23"><a href="non-identifiability-in-mixture-models-an-example.html#cb4-23" tabindex="-1"></a><span class="co"># Display plots side by side</span></span>
<span id="cb4-24"><a href="non-identifiability-in-mixture-models-an-example.html#cb4-24" tabindex="-1"></a><span class="fu">grid.arrange</span>(plot1, plot2, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-3-1.png" width="1200" style="display: block; margin: auto;" /></p>
</div>
<div id="comparing-distributions-directly" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> Comparing Distributions Directly<a href="non-identifiability-in-mixture-models-an-example.html#comparing-distributions-directly" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s compare the theoretical probability mass functions of both parameter sets to better visualize their similarity:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="non-identifiability-in-mixture-models-an-example.html#cb5-1" tabindex="-1"></a><span class="co"># Create a function to compute the theoretical PMF</span></span>
<span id="cb5-2"><a href="non-identifiability-in-mixture-models-an-example.html#cb5-2" tabindex="-1"></a>compute_binomial_mixture_pmf <span class="ot">&lt;-</span> <span class="cf">function</span>(n_trials, alpha, p1, p2) {</span>
<span id="cb5-3"><a href="non-identifiability-in-mixture-models-an-example.html#cb5-3" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span>n_trials</span>
<span id="cb5-4"><a href="non-identifiability-in-mixture-models-an-example.html#cb5-4" tabindex="-1"></a>  pmf <span class="ot">&lt;-</span> alpha <span class="sc">*</span> <span class="fu">dbinom</span>(x, n_trials, p1) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">*</span> <span class="fu">dbinom</span>(x, n_trials, p2)</span>
<span id="cb5-5"><a href="non-identifiability-in-mixture-models-an-example.html#cb5-5" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">density =</span> pmf, </span>
<span id="cb5-6"><a href="non-identifiability-in-mixture-models-an-example.html#cb5-6" tabindex="-1"></a>                    <span class="at">parameters =</span> <span class="fu">sprintf</span>(<span class="st">&quot;α=%.1f, p₁=%.1f, p₂=%.1f&quot;</span>, alpha, p1, p2)))</span>
<span id="cb5-7"><a href="non-identifiability-in-mixture-models-an-example.html#cb5-7" tabindex="-1"></a>}</span>
<span id="cb5-8"><a href="non-identifiability-in-mixture-models-an-example.html#cb5-8" tabindex="-1"></a></span>
<span id="cb5-9"><a href="non-identifiability-in-mixture-models-an-example.html#cb5-9" tabindex="-1"></a><span class="co"># Compute PMFs for both parameter sets</span></span>
<span id="cb5-10"><a href="non-identifiability-in-mixture-models-an-example.html#cb5-10" tabindex="-1"></a>pmf1 <span class="ot">&lt;-</span> <span class="fu">compute_binomial_mixture_pmf</span>(n_trials, alpha1, p1_1, p2_1)</span>
<span id="cb5-11"><a href="non-identifiability-in-mixture-models-an-example.html#cb5-11" tabindex="-1"></a>pmf2 <span class="ot">&lt;-</span> <span class="fu">compute_binomial_mixture_pmf</span>(n_trials, alpha2, p1_2, p2_2)</span>
<span id="cb5-12"><a href="non-identifiability-in-mixture-models-an-example.html#cb5-12" tabindex="-1"></a></span>
<span id="cb5-13"><a href="non-identifiability-in-mixture-models-an-example.html#cb5-13" tabindex="-1"></a><span class="co"># Combine data for plotting</span></span>
<span id="cb5-14"><a href="non-identifiability-in-mixture-models-an-example.html#cb5-14" tabindex="-1"></a>combined_pmf <span class="ot">&lt;-</span> <span class="fu">rbind</span>(pmf1, pmf2)</span>
<span id="cb5-15"><a href="non-identifiability-in-mixture-models-an-example.html#cb5-15" tabindex="-1"></a></span>
<span id="cb5-16"><a href="non-identifiability-in-mixture-models-an-example.html#cb5-16" tabindex="-1"></a><span class="co"># Create comparison plot</span></span>
<span id="cb5-17"><a href="non-identifiability-in-mixture-models-an-example.html#cb5-17" tabindex="-1"></a><span class="fu">ggplot</span>(combined_pmf, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> density, <span class="at">color =</span> parameters, <span class="at">group =</span> parameters)) <span class="sc">+</span></span>
<span id="cb5-18"><a href="non-identifiability-in-mixture-models-an-example.html#cb5-18" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb5-19"><a href="non-identifiability-in-mixture-models-an-example.html#cb5-19" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb5-20"><a href="non-identifiability-in-mixture-models-an-example.html#cb5-20" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Comparison of Theoretical Probability Mass Functions&quot;</span>,</span>
<span id="cb5-21"><a href="non-identifiability-in-mixture-models-an-example.html#cb5-21" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Different parameter sets producing similar distributions&quot;</span>,</span>
<span id="cb5-22"><a href="non-identifiability-in-mixture-models-an-example.html#cb5-22" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Number of Successes&quot;</span>,</span>
<span id="cb5-23"><a href="non-identifiability-in-mixture-models-an-example.html#cb5-23" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Probability&quot;</span>,</span>
<span id="cb5-24"><a href="non-identifiability-in-mixture-models-an-example.html#cb5-24" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Parameter Set&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-25"><a href="non-identifiability-in-mixture-models-an-example.html#cb5-25" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb5-26"><a href="non-identifiability-in-mixture-models-an-example.html#cb5-26" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb5-27"><a href="non-identifiability-in-mixture-models-an-example.html#cb5-27" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb5-28"><a href="non-identifiability-in-mixture-models-an-example.html#cb5-28" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb5-29"><a href="non-identifiability-in-mixture-models-an-example.html#cb5-29" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb5-30"><a href="non-identifiability-in-mixture-models-an-example.html#cb5-30" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb5-31"><a href="non-identifiability-in-mixture-models-an-example.html#cb5-31" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb5-32"><a href="non-identifiability-in-mixture-models-an-example.html#cb5-32" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb5-33"><a href="non-identifiability-in-mixture-models-an-example.html#cb5-33" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>)</span>
<span id="cb5-34"><a href="non-identifiability-in-mixture-models-an-example.html#cb5-34" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-4-1.png" width="1200" style="display: block; margin: auto;" /></p>
</div>
<div id="exploring-parameter-space" class="section level2 hasAnchor" number="6.6">
<h2><span class="header-section-number">6.6</span> Exploring Parameter Space<a href="non-identifiability-in-mixture-models-an-example.html#exploring-parameter-space" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s explore a wider range of parameter combinations to better understand non-identifiability in this model:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="non-identifiability-in-mixture-models-an-example.html#cb6-1" tabindex="-1"></a><span class="co"># Create a grid of different parameter combinations</span></span>
<span id="cb6-2"><a href="non-identifiability-in-mixture-models-an-example.html#cb6-2" tabindex="-1"></a>param_grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb6-3"><a href="non-identifiability-in-mixture-models-an-example.html#cb6-3" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">0.7</span>),</span>
<span id="cb6-4"><a href="non-identifiability-in-mixture-models-an-example.html#cb6-4" tabindex="-1"></a>  <span class="at">p1 =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.4</span>),</span>
<span id="cb6-5"><a href="non-identifiability-in-mixture-models-an-example.html#cb6-5" tabindex="-1"></a>  <span class="at">p2 =</span> <span class="fu">c</span>(<span class="fl">0.6</span>, <span class="fl">0.7</span>, <span class="fl">0.8</span>)</span>
<span id="cb6-6"><a href="non-identifiability-in-mixture-models-an-example.html#cb6-6" tabindex="-1"></a>)</span>
<span id="cb6-7"><a href="non-identifiability-in-mixture-models-an-example.html#cb6-7" tabindex="-1"></a></span>
<span id="cb6-8"><a href="non-identifiability-in-mixture-models-an-example.html#cb6-8" tabindex="-1"></a><span class="co"># Compute PMF for each parameter combination</span></span>
<span id="cb6-9"><a href="non-identifiability-in-mixture-models-an-example.html#cb6-9" tabindex="-1"></a>pmf_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb6-10"><a href="non-identifiability-in-mixture-models-an-example.html#cb6-10" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(param_grid)) {</span>
<span id="cb6-11"><a href="non-identifiability-in-mixture-models-an-example.html#cb6-11" tabindex="-1"></a>  pmf_list[[i]] <span class="ot">&lt;-</span> <span class="fu">compute_binomial_mixture_pmf</span>(</span>
<span id="cb6-12"><a href="non-identifiability-in-mixture-models-an-example.html#cb6-12" tabindex="-1"></a>    n_trials, </span>
<span id="cb6-13"><a href="non-identifiability-in-mixture-models-an-example.html#cb6-13" tabindex="-1"></a>    param_grid<span class="sc">$</span>alpha[i], </span>
<span id="cb6-14"><a href="non-identifiability-in-mixture-models-an-example.html#cb6-14" tabindex="-1"></a>    param_grid<span class="sc">$</span>p1[i], </span>
<span id="cb6-15"><a href="non-identifiability-in-mixture-models-an-example.html#cb6-15" tabindex="-1"></a>    param_grid<span class="sc">$</span>p2[i]</span>
<span id="cb6-16"><a href="non-identifiability-in-mixture-models-an-example.html#cb6-16" tabindex="-1"></a>  )</span>
<span id="cb6-17"><a href="non-identifiability-in-mixture-models-an-example.html#cb6-17" tabindex="-1"></a>}</span>
<span id="cb6-18"><a href="non-identifiability-in-mixture-models-an-example.html#cb6-18" tabindex="-1"></a></span>
<span id="cb6-19"><a href="non-identifiability-in-mixture-models-an-example.html#cb6-19" tabindex="-1"></a><span class="co"># Combine all PMFs</span></span>
<span id="cb6-20"><a href="non-identifiability-in-mixture-models-an-example.html#cb6-20" tabindex="-1"></a>all_pmfs <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, pmf_list)</span>
<span id="cb6-21"><a href="non-identifiability-in-mixture-models-an-example.html#cb6-21" tabindex="-1"></a></span>
<span id="cb6-22"><a href="non-identifiability-in-mixture-models-an-example.html#cb6-22" tabindex="-1"></a><span class="co"># Plot all PMFs</span></span>
<span id="cb6-23"><a href="non-identifiability-in-mixture-models-an-example.html#cb6-23" tabindex="-1"></a><span class="fu">ggplot</span>(all_pmfs, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> density, <span class="at">color =</span> parameters, <span class="at">group =</span> parameters)) <span class="sc">+</span></span>
<span id="cb6-24"><a href="non-identifiability-in-mixture-models-an-example.html#cb6-24" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb6-25"><a href="non-identifiability-in-mixture-models-an-example.html#cb6-25" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Multiple Parameter Combinations of Binomial Mixtures&quot;</span>,</span>
<span id="cb6-26"><a href="non-identifiability-in-mixture-models-an-example.html#cb6-26" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Illustrating parameter redundancy and non-identifiability&quot;</span>,</span>
<span id="cb6-27"><a href="non-identifiability-in-mixture-models-an-example.html#cb6-27" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Number of Successes&quot;</span>,</span>
<span id="cb6-28"><a href="non-identifiability-in-mixture-models-an-example.html#cb6-28" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Probability&quot;</span>,</span>
<span id="cb6-29"><a href="non-identifiability-in-mixture-models-an-example.html#cb6-29" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Parameters&quot;</span>) <span class="sc">+</span></span>
<span id="cb6-30"><a href="non-identifiability-in-mixture-models-an-example.html#cb6-30" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb6-31"><a href="non-identifiability-in-mixture-models-an-example.html#cb6-31" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb6-32"><a href="non-identifiability-in-mixture-models-an-example.html#cb6-32" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb6-33"><a href="non-identifiability-in-mixture-models-an-example.html#cb6-33" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb6-34"><a href="non-identifiability-in-mixture-models-an-example.html#cb6-34" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb6-35"><a href="non-identifiability-in-mixture-models-an-example.html#cb6-35" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb6-36"><a href="non-identifiability-in-mixture-models-an-example.html#cb6-36" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;right&quot;</span>,</span>
<span id="cb6-37"><a href="non-identifiability-in-mixture-models-an-example.html#cb6-37" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>)</span>
<span id="cb6-38"><a href="non-identifiability-in-mixture-models-an-example.html#cb6-38" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-5-1.png" width="1200" style="display: block; margin: auto;" /></p>
</div>
<div id="practical-implications-for-inference" class="section level2 hasAnchor" number="6.7">
<h2><span class="header-section-number">6.7</span> Practical Implications for Inference<a href="non-identifiability-in-mixture-models-an-example.html#practical-implications-for-inference" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To demonstrate the challenge of parameter recovery, let’s try to infer the parameters from simulated data using a simple method of moments approach:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-1" tabindex="-1"></a><span class="co"># Function to calculate the first three moments of a binomial mixture</span></span>
<span id="cb7-2"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-2" tabindex="-1"></a>calc_moments <span class="ot">&lt;-</span> <span class="cf">function</span>(n_trials, alpha, p1, p2) {</span>
<span id="cb7-3"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-3" tabindex="-1"></a>  <span class="co"># Mean</span></span>
<span id="cb7-4"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-4" tabindex="-1"></a>  m1 <span class="ot">&lt;-</span> n_trials <span class="sc">*</span> (alpha <span class="sc">*</span> p1 <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">*</span> p2)</span>
<span id="cb7-5"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-5" tabindex="-1"></a>  </span>
<span id="cb7-6"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-6" tabindex="-1"></a>  <span class="co"># Second central moment (variance)</span></span>
<span id="cb7-7"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-7" tabindex="-1"></a>  var1 <span class="ot">&lt;-</span> n_trials <span class="sc">*</span> alpha <span class="sc">*</span> p1 <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p1)</span>
<span id="cb7-8"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-8" tabindex="-1"></a>  var2 <span class="ot">&lt;-</span> n_trials <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">*</span> p2 <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p2)</span>
<span id="cb7-9"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-9" tabindex="-1"></a>  mixture_var <span class="ot">&lt;-</span> var1 <span class="sc">+</span> var2 <span class="sc">+</span> n_trials<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> alpha <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">*</span> (p1 <span class="sc">-</span> p2)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb7-10"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-10" tabindex="-1"></a>  m2 <span class="ot">&lt;-</span> mixture_var</span>
<span id="cb7-11"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-11" tabindex="-1"></a>  </span>
<span id="cb7-12"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-12" tabindex="-1"></a>  <span class="co"># Third central moment (skewness related)</span></span>
<span id="cb7-13"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-13" tabindex="-1"></a>  m3 <span class="ot">&lt;-</span> alpha <span class="sc">*</span> (p1 <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p1) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>p1)) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">*</span> (p2 <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p2) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>p2))</span>
<span id="cb7-14"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-14" tabindex="-1"></a>  m3 <span class="ot">&lt;-</span> m3 <span class="sc">*</span> n_trials <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> n_trials <span class="sc">*</span> (n_trials <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> </span>
<span id="cb7-15"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-15" tabindex="-1"></a>        (alpha <span class="sc">*</span> p1<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p1) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">*</span> p2<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p2)) <span class="sc">+</span></span>
<span id="cb7-16"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-16" tabindex="-1"></a>        n_trials <span class="sc">*</span> (n_trials <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (n_trials <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">*</span> </span>
<span id="cb7-17"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-17" tabindex="-1"></a>        (alpha <span class="sc">*</span> p1<span class="sc">^</span><span class="dv">3</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">*</span> p2<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb7-18"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-18" tabindex="-1"></a>  </span>
<span id="cb7-19"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-19" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(m1, m2, m3))</span>
<span id="cb7-20"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-20" tabindex="-1"></a>}</span>
<span id="cb7-21"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-21" tabindex="-1"></a></span>
<span id="cb7-22"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-22" tabindex="-1"></a><span class="co"># Function to compute the distance between two sets of moments</span></span>
<span id="cb7-23"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-23" tabindex="-1"></a>moment_distance <span class="ot">&lt;-</span> <span class="cf">function</span>(params, observed_moments, n_trials) {</span>
<span id="cb7-24"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-24" tabindex="-1"></a>  alpha <span class="ot">&lt;-</span> params[<span class="dv">1</span>]</span>
<span id="cb7-25"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-25" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> params[<span class="dv">2</span>]</span>
<span id="cb7-26"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-26" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> params[<span class="dv">3</span>]</span>
<span id="cb7-27"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-27" tabindex="-1"></a>  </span>
<span id="cb7-28"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-28" tabindex="-1"></a>  <span class="co"># Ensure parameters are within valid range</span></span>
<span id="cb7-29"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-29" tabindex="-1"></a>  <span class="cf">if</span> (alpha <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">||</span> alpha <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">||</span> p1 <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">||</span> p1 <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">||</span> p2 <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">||</span> p2 <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb7-30"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-30" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">Inf</span>)</span>
<span id="cb7-31"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-31" tabindex="-1"></a>  }</span>
<span id="cb7-32"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-32" tabindex="-1"></a>  </span>
<span id="cb7-33"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-33" tabindex="-1"></a>  theoretical_moments <span class="ot">&lt;-</span> <span class="fu">calc_moments</span>(n_trials, alpha, p1, p2)</span>
<span id="cb7-34"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-34" tabindex="-1"></a>  </span>
<span id="cb7-35"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-35" tabindex="-1"></a>  <span class="co"># Calculate sum of squared differences between moments</span></span>
<span id="cb7-36"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-36" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sum</span>((theoretical_moments <span class="sc">-</span> observed_moments)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb7-37"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-37" tabindex="-1"></a>}</span>
<span id="cb7-38"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-38" tabindex="-1"></a></span>
<span id="cb7-39"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-39" tabindex="-1"></a><span class="co"># Simulate data with known parameters</span></span>
<span id="cb7-40"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-40" tabindex="-1"></a>true_alpha <span class="ot">&lt;-</span> <span class="fl">0.6</span></span>
<span id="cb7-41"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-41" tabindex="-1"></a>true_p1 <span class="ot">&lt;-</span> <span class="fl">0.3</span></span>
<span id="cb7-42"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-42" tabindex="-1"></a>true_p2 <span class="ot">&lt;-</span> <span class="fl">0.8</span></span>
<span id="cb7-43"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-43" tabindex="-1"></a>n_trials <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb7-44"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-44" tabindex="-1"></a>n_samples <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb7-45"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-45" tabindex="-1"></a></span>
<span id="cb7-46"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-46" tabindex="-1"></a>simulated_data <span class="ot">&lt;-</span> <span class="fu">generate_binomial_mixture</span>(n_samples, n_trials, true_alpha, true_p1, true_p2)</span>
<span id="cb7-47"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-47" tabindex="-1"></a></span>
<span id="cb7-48"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-48" tabindex="-1"></a><span class="co"># Calculate empirical moments from the data</span></span>
<span id="cb7-49"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-49" tabindex="-1"></a>emp_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(simulated_data<span class="sc">$</span>samples)</span>
<span id="cb7-50"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-50" tabindex="-1"></a>emp_var <span class="ot">&lt;-</span> <span class="fu">var</span>(simulated_data<span class="sc">$</span>samples)</span>
<span id="cb7-51"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-51" tabindex="-1"></a>emp_m3 <span class="ot">&lt;-</span> <span class="fu">mean</span>((simulated_data<span class="sc">$</span>samples <span class="sc">-</span> emp_mean)<span class="sc">^</span><span class="dv">3</span>)  <span class="co"># Third central moment</span></span>
<span id="cb7-52"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-52" tabindex="-1"></a>observed_moments <span class="ot">&lt;-</span> <span class="fu">c</span>(emp_mean, emp_var, emp_m3)</span>
<span id="cb7-53"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-53" tabindex="-1"></a></span>
<span id="cb7-54"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-54" tabindex="-1"></a><span class="co"># Create a grid of parameter values to evaluate moments</span></span>
<span id="cb7-55"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-55" tabindex="-1"></a>alpha_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb7-56"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-56" tabindex="-1"></a>p1_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb7-57"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-57" tabindex="-1"></a>p2_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb7-58"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-58" tabindex="-1"></a></span>
<span id="cb7-59"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-59" tabindex="-1"></a><span class="co"># Create a data frame to store results</span></span>
<span id="cb7-60"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-60" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">alpha =</span> alpha_grid, <span class="at">p1 =</span> p1_grid, <span class="at">p2 =</span> p2_grid)</span>
<span id="cb7-61"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-61" tabindex="-1"></a>results<span class="sc">$</span>distance <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb7-62"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-62" tabindex="-1"></a></span>
<span id="cb7-63"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-63" tabindex="-1"></a><span class="co"># Calculate moment distance for each parameter combination</span></span>
<span id="cb7-64"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-64" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(results)) {</span>
<span id="cb7-65"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-65" tabindex="-1"></a>  results<span class="sc">$</span>distance[i] <span class="ot">&lt;-</span> <span class="fu">moment_distance</span>(</span>
<span id="cb7-66"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-66" tabindex="-1"></a>    <span class="fu">c</span>(results<span class="sc">$</span>alpha[i], results<span class="sc">$</span>p1[i], results<span class="sc">$</span>p2[i]),</span>
<span id="cb7-67"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-67" tabindex="-1"></a>    observed_moments,</span>
<span id="cb7-68"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-68" tabindex="-1"></a>    n_trials</span>
<span id="cb7-69"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-69" tabindex="-1"></a>  )</span>
<span id="cb7-70"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-70" tabindex="-1"></a>}</span>
<span id="cb7-71"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-71" tabindex="-1"></a></span>
<span id="cb7-72"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-72" tabindex="-1"></a><span class="co"># Filter out invalid combinations (where p1 ≥ p2)</span></span>
<span id="cb7-73"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-73" tabindex="-1"></a>results <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb7-74"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-74" tabindex="-1"></a>  <span class="fu">filter</span>(p1 <span class="sc">&lt;</span> p2) <span class="sc">%&gt;%</span></span>
<span id="cb7-75"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-75" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.finite</span>(distance)) <span class="sc">%&gt;%</span></span>
<span id="cb7-76"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-76" tabindex="-1"></a>  <span class="co"># Scale distances for better visualization</span></span>
<span id="cb7-77"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-77" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">relative_distance =</span> distance <span class="sc">/</span> <span class="fu">max</span>(distance))</span>
<span id="cb7-78"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-78" tabindex="-1"></a></span>
<span id="cb7-79"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-79" tabindex="-1"></a><span class="co"># Find the top 5 best fitting parameter combinations</span></span>
<span id="cb7-80"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-80" tabindex="-1"></a><span class="co"># Find the top 5 best fitting parameter combinations</span></span>
<span id="cb7-81"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-81" tabindex="-1"></a>top_fits <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span></span>
<span id="cb7-82"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-82" tabindex="-1"></a>  <span class="fu">arrange</span>(distance) <span class="sc">%&gt;%</span></span>
<span id="cb7-83"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-83" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>)</span>
<span id="cb7-84"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-84" tabindex="-1"></a></span>
<span id="cb7-85"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-85" tabindex="-1"></a><span class="co"># Show true parameters vs estimated parameters</span></span>
<span id="cb7-86"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-86" tabindex="-1"></a>true_params <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb7-87"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-87" tabindex="-1"></a>  <span class="at">alpha =</span> true_alpha,</span>
<span id="cb7-88"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-88" tabindex="-1"></a>  <span class="at">p1 =</span> true_p1,</span>
<span id="cb7-89"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-89" tabindex="-1"></a>  <span class="at">p2 =</span> true_p2,</span>
<span id="cb7-90"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-90" tabindex="-1"></a>  <span class="at">distance =</span> <span class="dv">0</span>,           <span class="co"># Change from NA to 0</span></span>
<span id="cb7-91"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-91" tabindex="-1"></a>  <span class="at">relative_distance =</span> <span class="dv">0</span>,  <span class="co"># Change from NA to 0</span></span>
<span id="cb7-92"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-92" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;True Parameters&quot;</span></span>
<span id="cb7-93"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-93" tabindex="-1"></a>)</span>
<span id="cb7-94"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-94" tabindex="-1"></a></span>
<span id="cb7-95"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-95" tabindex="-1"></a>top_fits<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="st">&quot;Estimated Parameters&quot;</span></span>
<span id="cb7-96"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-96" tabindex="-1"></a></span>
<span id="cb7-97"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-97" tabindex="-1"></a>comparison <span class="ot">&lt;-</span> <span class="fu">rbind</span>(true_params, top_fits)</span>
<span id="cb7-98"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-98" tabindex="-1"></a></span>
<span id="cb7-99"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-99" tabindex="-1"></a><span class="co"># Print comparison table</span></span>
<span id="cb7-100"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-100" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(comparison, </span>
<span id="cb7-101"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-101" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">&quot;True vs. Estimated Parameters&quot;</span>,</span>
<span id="cb7-102"><a href="non-identifiability-in-mixture-models-an-example.html#cb7-102" tabindex="-1"></a>             <span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-6">Table 6.1: </span>True vs. Estimated Parameters</caption>
<thead>
<tr class="header">
<th align="right">alpha</th>
<th align="right">p1</th>
<th align="right">p2</th>
<th align="right">distance</th>
<th align="right">relative_distance</th>
<th align="left">type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.6</td>
<td align="right">0.3</td>
<td align="right">0.8</td>
<td align="right">0.000</td>
<td align="right">0</td>
<td align="left">True Parameters</td>
</tr>
<tr class="even">
<td align="right">0.6</td>
<td align="right">0.1</td>
<td align="right">0.2</td>
<td align="right">667.831</td>
<td align="right">0</td>
<td align="left">Estimated Parameters</td>
</tr>
<tr class="odd">
<td align="right">0.5</td>
<td align="right">0.1</td>
<td align="right">0.2</td>
<td align="right">675.903</td>
<td align="right">0</td>
<td align="left">Estimated Parameters</td>
</tr>
<tr class="even">
<td align="right">0.9</td>
<td align="right">0.1</td>
<td align="right">0.3</td>
<td align="right">728.359</td>
<td align="right">0</td>
<td align="left">Estimated Parameters</td>
</tr>
<tr class="odd">
<td align="right">0.7</td>
<td align="right">0.1</td>
<td align="right">0.2</td>
<td align="right">775.146</td>
<td align="right">0</td>
<td align="left">Estimated Parameters</td>
</tr>
<tr class="even">
<td align="right">0.4</td>
<td align="right">0.1</td>
<td align="right">0.2</td>
<td align="right">799.275</td>
<td align="right">0</td>
<td align="left">Estimated Parameters</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="non-identifiability-in-mixture-models-an-example.html#cb8-1" tabindex="-1"></a><span class="co"># Create visualization of parameter space</span></span>
<span id="cb8-2"><a href="non-identifiability-in-mixture-models-an-example.html#cb8-2" tabindex="-1"></a><span class="fu">ggplot</span>(results <span class="sc">%&gt;%</span> <span class="fu">filter</span>(relative_distance <span class="sc">&lt;</span> <span class="fl">0.1</span>), </span>
<span id="cb8-3"><a href="non-identifiability-in-mixture-models-an-example.html#cb8-3" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> p1, <span class="at">y =</span> p2, <span class="at">color =</span> alpha, <span class="at">size =</span> <span class="dv">1</span><span class="sc">-</span>relative_distance)) <span class="sc">+</span></span>
<span id="cb8-4"><a href="non-identifiability-in-mixture-models-an-example.html#cb8-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb8-5"><a href="non-identifiability-in-mixture-models-an-example.html#cb8-5" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb8-6"><a href="non-identifiability-in-mixture-models-an-example.html#cb8-6" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>() <span class="sc">+</span></span>
<span id="cb8-7"><a href="non-identifiability-in-mixture-models-an-example.html#cb8-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Parameter Combinations with Similar Fit to Data&quot;</span>,</span>
<span id="cb8-8"><a href="non-identifiability-in-mixture-models-an-example.html#cb8-8" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Points show parameter combinations with low moment distance&quot;</span>,</span>
<span id="cb8-9"><a href="non-identifiability-in-mixture-models-an-example.html#cb8-9" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;p₁&quot;</span>,</span>
<span id="cb8-10"><a href="non-identifiability-in-mixture-models-an-example.html#cb8-10" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;p₂&quot;</span>,</span>
<span id="cb8-11"><a href="non-identifiability-in-mixture-models-an-example.html#cb8-11" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;α&quot;</span>,</span>
<span id="cb8-12"><a href="non-identifiability-in-mixture-models-an-example.html#cb8-12" tabindex="-1"></a>       <span class="at">size =</span> <span class="st">&quot;Goodness of fit&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-13"><a href="non-identifiability-in-mixture-models-an-example.html#cb8-13" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> true_params, <span class="fu">aes</span>(<span class="at">x =</span> p1, <span class="at">y =</span> p2), </span>
<span id="cb8-14"><a href="non-identifiability-in-mixture-models-an-example.html#cb8-14" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">shape =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb8-15"><a href="non-identifiability-in-mixture-models-an-example.html#cb8-15" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> true_p1, <span class="at">y =</span> true_p2 <span class="sc">+</span> <span class="fl">0.05</span>, </span>
<span id="cb8-16"><a href="non-identifiability-in-mixture-models-an-example.html#cb8-16" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;True parameters</span><span class="sc">\n</span><span class="st">(distance = 0)&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">fontface =</span> <span class="st">&quot;bold&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-17"><a href="non-identifiability-in-mixture-models-an-example.html#cb8-17" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb8-18"><a href="non-identifiability-in-mixture-models-an-example.html#cb8-18" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;right&quot;</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-6-1.png" width="1200" style="display: block; margin: auto;" /></p>
</div>
<div id="non-identifiability-as-a-function-of-separation" class="section level2 hasAnchor" number="6.8">
<h2><span class="header-section-number">6.8</span> Non-Identifiability as a Function of Separation<a href="non-identifiability-in-mixture-models-an-example.html#non-identifiability-as-a-function-of-separation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s examine how the degree of non-identifiability depends on the separation between the component distributions. Intuitively, we might expect that when the two binomial components have very different success probabilities, it becomes easier to identify the true parameters.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-1" tabindex="-1"></a><span class="co"># Examine how the set of alternative parameters changes with the separation between p₁ and p₂</span></span>
<span id="cb9-2"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-2" tabindex="-1"></a></span>
<span id="cb9-3"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-3" tabindex="-1"></a><span class="co"># Define a sequence of increasing separations between p₁ and p₂</span></span>
<span id="cb9-4"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-4" tabindex="-1"></a>separation_sequence <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.8</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb9-5"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-5" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span>  <span class="co"># Number of trials in binomial</span></span>
<span id="cb9-6"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-6" tabindex="-1"></a></span>
<span id="cb9-7"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-7" tabindex="-1"></a><span class="co"># Create a plot to visualize how the set of alternative parameters changes with separation</span></span>
<span id="cb9-8"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-8" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb9-9"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-9" tabindex="-1"></a></span>
<span id="cb9-10"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-10" tabindex="-1"></a><span class="cf">for</span> (sep <span class="cf">in</span> separation_sequence) {</span>
<span id="cb9-11"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-11" tabindex="-1"></a>  <span class="co"># Define true parameters with increasing separation</span></span>
<span id="cb9-12"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-12" tabindex="-1"></a>  p1_true <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb9-13"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-13" tabindex="-1"></a>  p2_true <span class="ot">&lt;-</span> p1_true <span class="sc">+</span> sep</span>
<span id="cb9-14"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-14" tabindex="-1"></a>  lambda_true <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb9-15"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-15" tabindex="-1"></a>  </span>
<span id="cb9-16"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-16" tabindex="-1"></a>  <span class="co"># Create a grid of alternative parameter values</span></span>
<span id="cb9-17"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-17" tabindex="-1"></a>  p1_alt <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.01</span>, <span class="fl">0.99</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb9-18"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-18" tabindex="-1"></a>  p2_alt <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.01</span>, <span class="fl">0.99</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb9-19"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-19" tabindex="-1"></a>  grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">p1 =</span> p1_alt, <span class="at">p2 =</span> p2_alt)</span>
<span id="cb9-20"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-20" tabindex="-1"></a>  </span>
<span id="cb9-21"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-21" tabindex="-1"></a>  <span class="co"># Calculate PMF for the true parameters</span></span>
<span id="cb9-22"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-22" tabindex="-1"></a>  pmf_true <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb9-23"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-23" tabindex="-1"></a>  <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>n) {</span>
<span id="cb9-24"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-24" tabindex="-1"></a>    pmf_true[k<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> lambda_true <span class="sc">*</span> <span class="fu">dbinom</span>(k, n, p1_true) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> lambda_true) <span class="sc">*</span> <span class="fu">dbinom</span>(k, n, p2_true)</span>
<span id="cb9-25"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-25" tabindex="-1"></a>  }</span>
<span id="cb9-26"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-26" tabindex="-1"></a>  </span>
<span id="cb9-27"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-27" tabindex="-1"></a>  <span class="co"># Calculate KL divergence for each grid point</span></span>
<span id="cb9-28"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-28" tabindex="-1"></a>  kl_div <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">nrow</span>(grid))</span>
<span id="cb9-29"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-29" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(grid)) {</span>
<span id="cb9-30"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-30" tabindex="-1"></a>    <span class="co"># For each alternative (p1, p2) pair, find the lambda that minimizes KL divergence</span></span>
<span id="cb9-31"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-31" tabindex="-1"></a>    minimize_kl <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda) {</span>
<span id="cb9-32"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-32" tabindex="-1"></a>      pmf_alt <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb9-33"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-33" tabindex="-1"></a>      <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>n) {</span>
<span id="cb9-34"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-34" tabindex="-1"></a>        pmf_alt[k<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> lambda <span class="sc">*</span> <span class="fu">dbinom</span>(k, n, grid<span class="sc">$</span>p1[i]) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> lambda) <span class="sc">*</span> <span class="fu">dbinom</span>(k, n, grid<span class="sc">$</span>p2[i])</span>
<span id="cb9-35"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-35" tabindex="-1"></a>      }</span>
<span id="cb9-36"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-36" tabindex="-1"></a>      </span>
<span id="cb9-37"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-37" tabindex="-1"></a>      <span class="co"># Avoid log(0) issues</span></span>
<span id="cb9-38"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-38" tabindex="-1"></a>      pmf_alt <span class="ot">&lt;-</span> <span class="fu">pmax</span>(pmf_alt, <span class="fl">1e-10</span>)</span>
<span id="cb9-39"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-39" tabindex="-1"></a>      pmf_true_safe <span class="ot">&lt;-</span> <span class="fu">pmax</span>(pmf_true, <span class="fl">1e-10</span>)</span>
<span id="cb9-40"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-40" tabindex="-1"></a>      </span>
<span id="cb9-41"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-41" tabindex="-1"></a>      <span class="co"># Calculate KL divergence</span></span>
<span id="cb9-42"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-42" tabindex="-1"></a>      kl <span class="ot">&lt;-</span> <span class="fu">sum</span>(pmf_true_safe <span class="sc">*</span> <span class="fu">log</span>(pmf_true_safe <span class="sc">/</span> pmf_alt))</span>
<span id="cb9-43"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-43" tabindex="-1"></a>      <span class="fu">return</span>(kl)</span>
<span id="cb9-44"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-44" tabindex="-1"></a>    }</span>
<span id="cb9-45"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-45" tabindex="-1"></a>    </span>
<span id="cb9-46"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-46" tabindex="-1"></a>    <span class="co"># Find optimal lambda using a grid search (for simplicity)</span></span>
<span id="cb9-47"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-47" tabindex="-1"></a>    lambda_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.01</span>, <span class="fl">0.99</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb9-48"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-48" tabindex="-1"></a>    kl_values <span class="ot">&lt;-</span> <span class="fu">sapply</span>(lambda_grid, minimize_kl)</span>
<span id="cb9-49"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-49" tabindex="-1"></a>    best_lambda_idx <span class="ot">&lt;-</span> <span class="fu">which.min</span>(kl_values)</span>
<span id="cb9-50"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-50" tabindex="-1"></a>    kl_div[i] <span class="ot">&lt;-</span> kl_values[best_lambda_idx]</span>
<span id="cb9-51"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-51" tabindex="-1"></a>  }</span>
<span id="cb9-52"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-52" tabindex="-1"></a>  </span>
<span id="cb9-53"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-53" tabindex="-1"></a>  <span class="co"># Convert to matrix for contour plot</span></span>
<span id="cb9-54"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-54" tabindex="-1"></a>  kl_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(kl_div, <span class="at">nrow =</span> <span class="fu">length</span>(p1_alt), <span class="at">ncol =</span> <span class="fu">length</span>(p2_alt))</span>
<span id="cb9-55"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-55" tabindex="-1"></a>  </span>
<span id="cb9-56"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-56" tabindex="-1"></a>  <span class="co"># Plot contours of KL divergence</span></span>
<span id="cb9-57"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-57" tabindex="-1"></a>  contour_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.001</span>, <span class="fl">0.005</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>)</span>
<span id="cb9-58"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-58" tabindex="-1"></a>  </span>
<span id="cb9-59"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-59" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="at">type =</span> <span class="st">&quot;n&quot;</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), </span>
<span id="cb9-60"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-60" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">&quot;p₁&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;p₂&quot;</span>, </span>
<span id="cb9-61"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-61" tabindex="-1"></a>       <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;Separation = &quot;</span>, sep))</span>
<span id="cb9-62"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-62" tabindex="-1"></a>  </span>
<span id="cb9-63"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-63" tabindex="-1"></a>  <span class="co"># Add contour lines</span></span>
<span id="cb9-64"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-64" tabindex="-1"></a>  <span class="fu">contour</span>(p1_alt, p2_alt, kl_matrix, <span class="at">levels =</span> contour_levels, <span class="at">add =</span> <span class="cn">TRUE</span>, </span>
<span id="cb9-65"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-65" tabindex="-1"></a>          <span class="at">drawlabels =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb9-66"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-66" tabindex="-1"></a>  </span>
<span id="cb9-67"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-67" tabindex="-1"></a>  <span class="co"># Mark the true parameters</span></span>
<span id="cb9-68"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-68" tabindex="-1"></a>  <span class="fu">points</span>(p1_true, p2_true, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb9-69"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-69" tabindex="-1"></a>  </span>
<span id="cb9-70"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-70" tabindex="-1"></a>  <span class="co"># Add a line for p1 = p2</span></span>
<span id="cb9-71"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-71" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb9-72"><a href="non-identifiability-in-mixture-models-an-example.html#cb9-72" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-7-1.png" width="1200" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="non-identifiability-in-mixture-models-an-example.html#cb10-1" tabindex="-1"></a><span class="co"># Reset plot parameters</span></span>
<span id="cb10-2"><a href="non-identifiability-in-mixture-models-an-example.html#cb10-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>) <span class="sc">+</span> <span class="fl">0.1</span>)</span></code></pre></div>
<p>In the plot above, we can see that as the separation between p₁ and p₂ increases, the set of alternative parameters that generate similar distributions becomes more constrained. This demonstrates that non-identifiability is most pronounced when the component distributions are similar to each other.</p>
</div>
<div id="visualizing-the-non-identifiability-region" class="section level2 hasAnchor" number="6.9">
<h2><span class="header-section-number">6.9</span> Visualizing the Non-Identifiability Region<a href="non-identifiability-in-mixture-models-an-example.html#visualizing-the-non-identifiability-region" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s create a more detailed visualization of the parameter space that shows which combinations of parameters lead to nearly identical distributions:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-1" tabindex="-1"></a><span class="co"># Define a function to compute distance between distributions</span></span>
<span id="cb11-2"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-2" tabindex="-1"></a>compute_dist_between_distributions <span class="ot">&lt;-</span> <span class="cf">function</span>(n_trials, alpha1, p1_1, p2_1, alpha2, p1_2, p2_2) {</span>
<span id="cb11-3"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-3" tabindex="-1"></a>  <span class="co"># Compute PMFs</span></span>
<span id="cb11-4"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-4" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span>n_trials</span>
<span id="cb11-5"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-5" tabindex="-1"></a>  pmf1 <span class="ot">&lt;-</span> alpha1 <span class="sc">*</span> <span class="fu">dbinom</span>(x, n_trials, p1_1) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> alpha1) <span class="sc">*</span> <span class="fu">dbinom</span>(x, n_trials, p2_1)</span>
<span id="cb11-6"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-6" tabindex="-1"></a>  pmf2 <span class="ot">&lt;-</span> alpha2 <span class="sc">*</span> <span class="fu">dbinom</span>(x, n_trials, p1_2) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> alpha2) <span class="sc">*</span> <span class="fu">dbinom</span>(x, n_trials, p2_2)</span>
<span id="cb11-7"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-7" tabindex="-1"></a>  </span>
<span id="cb11-8"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-8" tabindex="-1"></a>  <span class="co"># Compute total variation distance</span></span>
<span id="cb11-9"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-9" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">sum</span>(<span class="fu">abs</span>(pmf1 <span class="sc">-</span> pmf2)))</span>
<span id="cb11-10"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-10" tabindex="-1"></a>}</span>
<span id="cb11-11"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-11" tabindex="-1"></a></span>
<span id="cb11-12"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-12" tabindex="-1"></a><span class="co"># Fix one parameter set</span></span>
<span id="cb11-13"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-13" tabindex="-1"></a>fixed_alpha <span class="ot">&lt;-</span> <span class="fl">0.7</span></span>
<span id="cb11-14"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-14" tabindex="-1"></a>fixed_p1 <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb11-15"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-15" tabindex="-1"></a>fixed_p2 <span class="ot">&lt;-</span> <span class="fl">0.6</span></span>
<span id="cb11-16"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-16" tabindex="-1"></a>n_trials <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb11-17"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-17" tabindex="-1"></a></span>
<span id="cb11-18"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-18" tabindex="-1"></a><span class="co"># Create grid of alternative parameters</span></span>
<span id="cb11-19"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-19" tabindex="-1"></a>alpha_alt <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.05</span>)</span>
<span id="cb11-20"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-20" tabindex="-1"></a>p1_alt <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="at">by =</span> <span class="fl">0.02</span>)</span>
<span id="cb11-21"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-21" tabindex="-1"></a>p2_alt <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.4</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.02</span>)</span>
<span id="cb11-22"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-22" tabindex="-1"></a></span>
<span id="cb11-23"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-23" tabindex="-1"></a><span class="co"># Create grid of all combinations</span></span>
<span id="cb11-24"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-24" tabindex="-1"></a>param_space <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">alpha =</span> alpha_alt, <span class="at">p1 =</span> p1_alt, <span class="at">p2 =</span> p2_alt)</span>
<span id="cb11-25"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-25" tabindex="-1"></a></span>
<span id="cb11-26"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-26" tabindex="-1"></a><span class="co"># Filter to ensure p1 &lt; p2</span></span>
<span id="cb11-27"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-27" tabindex="-1"></a>param_space <span class="ot">&lt;-</span> param_space <span class="sc">%&gt;%</span> <span class="fu">filter</span>(p1 <span class="sc">&lt;</span> p2)</span>
<span id="cb11-28"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-28" tabindex="-1"></a></span>
<span id="cb11-29"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-29" tabindex="-1"></a><span class="co"># Calculate distance for each parameter combination</span></span>
<span id="cb11-30"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-30" tabindex="-1"></a>param_space<span class="sc">$</span>distance <span class="ot">&lt;-</span> <span class="fu">mapply</span>(</span>
<span id="cb11-31"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-31" tabindex="-1"></a>  <span class="cf">function</span>(a, p1, p2) {</span>
<span id="cb11-32"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-32" tabindex="-1"></a>    <span class="fu">compute_dist_between_distributions</span>(n_trials, fixed_alpha, fixed_p1, fixed_p2, a, p1, p2)</span>
<span id="cb11-33"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-33" tabindex="-1"></a>  },</span>
<span id="cb11-34"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-34" tabindex="-1"></a>  param_space<span class="sc">$</span>alpha, param_space<span class="sc">$</span>p1, param_space<span class="sc">$</span>p2</span>
<span id="cb11-35"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-35" tabindex="-1"></a>)</span>
<span id="cb11-36"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-36" tabindex="-1"></a></span>
<span id="cb11-37"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-37" tabindex="-1"></a><span class="co"># Set a threshold for &quot;nearly identical&quot; distributions</span></span>
<span id="cb11-38"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-38" tabindex="-1"></a>threshold <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb11-39"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-39" tabindex="-1"></a>param_space<span class="sc">$</span>nearly_identical <span class="ot">&lt;-</span> param_space<span class="sc">$</span>distance <span class="sc">&lt;</span> threshold</span>
<span id="cb11-40"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-40" tabindex="-1"></a></span>
<span id="cb11-41"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-41" tabindex="-1"></a><span class="co"># Select more informative alpha slices (avoiding exact α = 0.7)</span></span>
<span id="cb11-42"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-42" tabindex="-1"></a>alpha_slices <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">0.65</span>)</span>
<span id="cb11-43"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-43" tabindex="-1"></a>sliced_data <span class="ot">&lt;-</span> param_space <span class="sc">%&gt;%</span> </span>
<span id="cb11-44"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-44" tabindex="-1"></a>  <span class="fu">filter</span>(alpha <span class="sc">%in%</span> alpha_slices)</span>
<span id="cb11-45"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-45" tabindex="-1"></a></span>
<span id="cb11-46"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-46" tabindex="-1"></a><span class="co"># Create reference point data frame</span></span>
<span id="cb11-47"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-47" tabindex="-1"></a>reference_point <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb11-48"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-48" tabindex="-1"></a>  <span class="at">p1 =</span> fixed_p1, </span>
<span id="cb11-49"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-49" tabindex="-1"></a>  <span class="at">p2 =</span> fixed_p2, </span>
<span id="cb11-50"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-50" tabindex="-1"></a>  <span class="at">alpha =</span> fixed_alpha,</span>
<span id="cb11-51"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-51" tabindex="-1"></a>  <span class="at">distance =</span> <span class="dv">0</span>,</span>
<span id="cb11-52"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-52" tabindex="-1"></a>  <span class="at">nearly_identical =</span> <span class="cn">TRUE</span></span>
<span id="cb11-53"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-53" tabindex="-1"></a>)</span>
<span id="cb11-54"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-54" tabindex="-1"></a></span>
<span id="cb11-55"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-55" tabindex="-1"></a><span class="co"># Set a maximum distance for better visualization</span></span>
<span id="cb11-56"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-56" tabindex="-1"></a>max_dist_for_scale <span class="ot">&lt;-</span> <span class="fu">quantile</span>(param_space<span class="sc">$</span>distance, <span class="fl">0.9</span>)</span>
<span id="cb11-57"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-57" tabindex="-1"></a></span>
<span id="cb11-58"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-58" tabindex="-1"></a><span class="co"># Create heatmap for each alpha slice</span></span>
<span id="cb11-59"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-59" tabindex="-1"></a><span class="fu">ggplot</span>(sliced_data, <span class="fu">aes</span>(<span class="at">x =</span> p1, <span class="at">y =</span> p2, <span class="at">fill =</span> distance)) <span class="sc">+</span></span>
<span id="cb11-60"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-60" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb11-61"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-61" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>alpha, <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">alpha =</span> <span class="cf">function</span>(x) <span class="fu">paste</span>(<span class="st">&quot;α =&quot;</span>, x))) <span class="sc">+</span></span>
<span id="cb11-62"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-62" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">&quot;plasma&quot;</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>, </span>
<span id="cb11-63"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-63" tabindex="-1"></a>                      <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, max_dist_for_scale), </span>
<span id="cb11-64"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-64" tabindex="-1"></a>                      <span class="at">oob =</span> scales<span class="sc">::</span>squish) <span class="sc">+</span></span>
<span id="cb11-65"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-65" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> reference_point <span class="sc">%&gt;%</span> <span class="fu">filter</span>(alpha <span class="sc">%in%</span> <span class="fu">c</span>(fixed_alpha)), </span>
<span id="cb11-66"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-66" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">4</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb11-67"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-67" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fl">0.15</span>, <span class="at">y =</span> <span class="fl">0.85</span>, </span>
<span id="cb11-68"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-68" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;Reference:&quot;</span>, fixed_alpha, fixed_p1, fixed_p2), </span>
<span id="cb11-69"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-69" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb11-70"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-70" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb11-71"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-71" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Non-Identifiability Regions in Parameter Space&quot;</span>,</span>
<span id="cb11-72"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-72" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">&quot;Distance from reference distribution (α = &quot;</span>, fixed_alpha, </span>
<span id="cb11-73"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-73" tabindex="-1"></a>                      <span class="st">&quot;, p₁ = &quot;</span>, fixed_p1, <span class="st">&quot;, p₂ = &quot;</span>, fixed_p2, <span class="st">&quot;)&quot;</span>),</span>
<span id="cb11-74"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-74" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;p₁&quot;</span>,</span>
<span id="cb11-75"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-75" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;p₂&quot;</span>,</span>
<span id="cb11-76"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-76" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;Distribution</span><span class="sc">\n</span><span class="st">Distance&quot;</span></span>
<span id="cb11-77"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-77" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-78"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-78" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb11-79"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-79" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb11-80"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-80" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb11-81"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-81" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb11-82"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-82" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>)</span>
<span id="cb11-83"><a href="non-identifiability-in-mixture-models-an-example.html#cb11-83" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-8-1.png" width="1200" style="display: block; margin: auto;" /></p>
<p>The heatmap above shows slices of the parameter space at different values of α. The darker regions represent parameter combinations that produce distributions very similar to our reference distribution. The red × marks the location of the reference parameters.</p>
</div>
<div id="the-likelihood-surface" class="section level2 hasAnchor" number="6.10">
<h2><span class="header-section-number">6.10</span> The Likelihood Surface<a href="non-identifiability-in-mixture-models-an-example.html#the-likelihood-surface" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Another way to visualize non-identifiability is through the likelihood surface. For a given dataset, multiple parameter combinations can achieve similarly high likelihood values:</p>
<p>Another way to visualize non-identifiability is through the likelihood surface. For a given dataset, multiple parameter combinations can achieve similarly high likelihood values:</p>
<p>Let’s create a more detailed visualization of the parameter space that shows which combinations of parameters lead to nearly identical distributions:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-1" tabindex="-1"></a><span class="co"># Generate a dataset from our reference parameters</span></span>
<span id="cb12-2"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb12-3"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-3" tabindex="-1"></a>reference_data <span class="ot">&lt;-</span> <span class="fu">generate_binomial_mixture</span>(<span class="dv">1000</span>, n_trials, fixed_alpha, fixed_p1, fixed_p2)</span>
<span id="cb12-4"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-4" tabindex="-1"></a></span>
<span id="cb12-5"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-5" tabindex="-1"></a><span class="co"># Function to compute log-likelihood for binomial mixture</span></span>
<span id="cb12-6"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-6" tabindex="-1"></a>compute_log_likelihood <span class="ot">&lt;-</span> <span class="cf">function</span>(data, n_trials, alpha, p1, p2) {</span>
<span id="cb12-7"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-7" tabindex="-1"></a>  x <span class="ot">&lt;-</span> data<span class="sc">$</span>samples</span>
<span id="cb12-8"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-8" tabindex="-1"></a>  pmf <span class="ot">&lt;-</span> alpha <span class="sc">*</span> <span class="fu">dbinom</span>(x, n_trials, p1) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">*</span> <span class="fu">dbinom</span>(x, n_trials, p2)</span>
<span id="cb12-9"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-9" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sum</span>(<span class="fu">log</span>(pmf)))</span>
<span id="cb12-10"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-10" tabindex="-1"></a>}</span>
<span id="cb12-11"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-11" tabindex="-1"></a></span>
<span id="cb12-12"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-12" tabindex="-1"></a><span class="co"># Calculate log-likelihood for our parameter grid</span></span>
<span id="cb12-13"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-13" tabindex="-1"></a>param_space<span class="sc">$</span>log_likelihood <span class="ot">&lt;-</span> <span class="fu">mapply</span>(</span>
<span id="cb12-14"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-14" tabindex="-1"></a>  <span class="cf">function</span>(a, p1, p2) {</span>
<span id="cb12-15"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-15" tabindex="-1"></a>    <span class="fu">compute_log_likelihood</span>(reference_data, n_trials, a, p1, p2)</span>
<span id="cb12-16"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-16" tabindex="-1"></a>  },</span>
<span id="cb12-17"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-17" tabindex="-1"></a>  param_space<span class="sc">$</span>alpha, param_space<span class="sc">$</span>p1, param_space<span class="sc">$</span>p2</span>
<span id="cb12-18"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-18" tabindex="-1"></a>)</span>
<span id="cb12-19"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-19" tabindex="-1"></a></span>
<span id="cb12-20"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-20" tabindex="-1"></a><span class="co"># Normalize log-likelihood for better visualization</span></span>
<span id="cb12-21"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-21" tabindex="-1"></a>param_space<span class="sc">$</span>rel_likelihood <span class="ot">&lt;-</span> param_space<span class="sc">$</span>log_likelihood <span class="sc">-</span> <span class="fu">max</span>(param_space<span class="sc">$</span>log_likelihood)</span>
<span id="cb12-22"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-22" tabindex="-1"></a></span>
<span id="cb12-23"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-23" tabindex="-1"></a><span class="co"># Select alpha values close to but not exactly at the reference</span></span>
<span id="cb12-24"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-24" tabindex="-1"></a>alpha_ll_slices <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.6</span>, <span class="fl">0.65</span>, <span class="fl">0.75</span>)</span>
<span id="cb12-25"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-25" tabindex="-1"></a>sliced_ll_data <span class="ot">&lt;-</span> param_space <span class="sc">%&gt;%</span> </span>
<span id="cb12-26"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-26" tabindex="-1"></a>  <span class="fu">filter</span>(alpha <span class="sc">%in%</span> alpha_ll_slices)</span>
<span id="cb12-27"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-27" tabindex="-1"></a></span>
<span id="cb12-28"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-28" tabindex="-1"></a><span class="co"># Calculate the log-likelihood for the reference parameters</span></span>
<span id="cb12-29"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-29" tabindex="-1"></a>ref_ll <span class="ot">&lt;-</span> <span class="fu">compute_log_likelihood</span>(reference_data, n_trials, fixed_alpha, fixed_p1, fixed_p2)</span>
<span id="cb12-30"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-30" tabindex="-1"></a>ref_rel_ll <span class="ot">&lt;-</span> ref_ll <span class="sc">-</span> <span class="fu">max</span>(param_space<span class="sc">$</span>log_likelihood)</span>
<span id="cb12-31"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-31" tabindex="-1"></a></span>
<span id="cb12-32"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-32" tabindex="-1"></a><span class="co"># Create a separate data frame for the reference point</span></span>
<span id="cb12-33"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-33" tabindex="-1"></a>reference_point_for_plot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb12-34"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-34" tabindex="-1"></a>  <span class="at">p1 =</span> fixed_p1,</span>
<span id="cb12-35"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-35" tabindex="-1"></a>  <span class="at">p2 =</span> fixed_p2,</span>
<span id="cb12-36"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-36" tabindex="-1"></a>  <span class="at">alpha =</span> fixed_alpha,</span>
<span id="cb12-37"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-37" tabindex="-1"></a>  <span class="at">log_likelihood =</span> ref_ll,</span>
<span id="cb12-38"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-38" tabindex="-1"></a>  <span class="at">rel_likelihood =</span> ref_rel_ll</span>
<span id="cb12-39"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-39" tabindex="-1"></a>)</span>
<span id="cb12-40"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-40" tabindex="-1"></a></span>
<span id="cb12-41"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-41" tabindex="-1"></a><span class="co"># Find a suitable minimum for the likelihood scale</span></span>
<span id="cb12-42"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-42" tabindex="-1"></a>min_ll_for_scale <span class="ot">&lt;-</span> <span class="fu">quantile</span>(sliced_ll_data<span class="sc">$</span>rel_likelihood, <span class="fl">0.1</span>)</span>
<span id="cb12-43"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-43" tabindex="-1"></a></span>
<span id="cb12-44"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-44" tabindex="-1"></a><span class="co"># Plot likelihood surface</span></span>
<span id="cb12-45"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-45" tabindex="-1"></a>ll_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(sliced_ll_data, <span class="fu">aes</span>(<span class="at">x =</span> p1, <span class="at">y =</span> p2, <span class="at">fill =</span> rel_likelihood)) <span class="sc">+</span></span>
<span id="cb12-46"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-46" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb12-47"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-47" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>alpha, <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">alpha =</span> <span class="cf">function</span>(x) <span class="fu">paste</span>(<span class="st">&quot;α =&quot;</span>, x))) <span class="sc">+</span></span>
<span id="cb12-48"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-48" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">&quot;white&quot;</span>, <span class="at">high =</span> <span class="st">&quot;darkblue&quot;</span>, </span>
<span id="cb12-49"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-49" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(min_ll_for_scale, <span class="dv">0</span>), </span>
<span id="cb12-50"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-50" tabindex="-1"></a>                     <span class="at">oob =</span> scales<span class="sc">::</span>squish) <span class="sc">+</span></span>
<span id="cb12-51"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-51" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fl">0.15</span>, <span class="at">y =</span> <span class="fl">0.85</span>, </span>
<span id="cb12-52"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-52" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;Reference:&quot;</span>, fixed_alpha, fixed_p1, fixed_p2), </span>
<span id="cb12-53"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-53" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb12-54"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-54" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb12-55"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-55" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Log-Likelihood Surface for Binomial Mixture&quot;</span>,</span>
<span id="cb12-56"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-56" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Showing regions of high likelihood (dark blue) across parameter space&quot;</span>,</span>
<span id="cb12-57"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-57" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;p₁&quot;</span>,</span>
<span id="cb12-58"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-58" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;p₂&quot;</span>,</span>
<span id="cb12-59"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-59" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;Relative</span><span class="sc">\n</span><span class="st">Log-Likelihood&quot;</span></span>
<span id="cb12-60"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-60" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb12-61"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-61" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb12-62"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-62" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb12-63"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-63" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb12-64"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-64" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb12-65"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-65" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>)</span>
<span id="cb12-66"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-66" tabindex="-1"></a>  )</span>
<span id="cb12-67"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-67" tabindex="-1"></a></span>
<span id="cb12-68"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-68" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb12-69"><a href="non-identifiability-in-mixture-models-an-example.html#cb12-69" tabindex="-1"></a>ll_plot</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-9-1.png" width="1200" style="display: block; margin: auto;" /></p>
<p>The likelihood surface shows a ridge of high-likelihood values rather than a single clear peak, which is characteristic of non-identifiable models. This ridge corresponds to different parameter combinations that explain the data equally well.</p>
</div>
<div id="practical-implications-and-solutions" class="section level2 hasAnchor" number="6.11">
<h2><span class="header-section-number">6.11</span> Practical Implications and Solutions<a href="non-identifiability-in-mixture-models-an-example.html#practical-implications-and-solutions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The non-identifiability of mixture models has important practical implications:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Parameter Interpretation</strong>: In non-identifiable models, individual parameter estimates may not be reliable or interpretable, even with large sample sizes.</p></li>
<li><p><strong>Uncertainty Quantification</strong>: Standard errors and confidence intervals can be misleading as they may not capture the true uncertainty.</p></li>
<li><p><strong>Model Selection</strong>: Simpler models with fewer parameters might be preferred even if they don’t fit the data as well.</p></li>
</ol>
<p>Some approaches to dealing with non-identifiability include:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Constraints</strong>: Imposing constraints on parameters (e.g., ordering the components by their means).</p></li>
<li><p><strong>Prior Information</strong>: Using Bayesian methods with informative priors.</p></li>
<li><p><strong>Alternative Parameterizations</strong>: Finding alternative ways to parameterize the model that are identifiable.</p></li>
</ol>
<p>Let’s demonstrate how adding constraints can help:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="non-identifiability-in-mixture-models-an-example.html#cb13-1" tabindex="-1"></a><span class="co"># Analyze identifiability with constraints</span></span>
<span id="cb13-2"><a href="non-identifiability-in-mixture-models-an-example.html#cb13-2" tabindex="-1"></a><span class="co"># Here we&#39;ll constrain p1 &lt; p2 and alpha &gt; 0.5</span></span>
<span id="cb13-3"><a href="non-identifiability-in-mixture-models-an-example.html#cb13-3" tabindex="-1"></a></span>
<span id="cb13-4"><a href="non-identifiability-in-mixture-models-an-example.html#cb13-4" tabindex="-1"></a><span class="co"># Filter our parameter space accordingly</span></span>
<span id="cb13-5"><a href="non-identifiability-in-mixture-models-an-example.html#cb13-5" tabindex="-1"></a>constrained_space <span class="ot">&lt;-</span> param_space <span class="sc">%&gt;%</span></span>
<span id="cb13-6"><a href="non-identifiability-in-mixture-models-an-example.html#cb13-6" tabindex="-1"></a>  <span class="fu">filter</span>(p1 <span class="sc">&lt;</span> p2, alpha <span class="sc">&gt;</span> <span class="fl">0.5</span>)</span>
<span id="cb13-7"><a href="non-identifiability-in-mixture-models-an-example.html#cb13-7" tabindex="-1"></a></span>
<span id="cb13-8"><a href="non-identifiability-in-mixture-models-an-example.html#cb13-8" tabindex="-1"></a><span class="co"># Visualize the constrained parameter space using better alpha values</span></span>
<span id="cb13-9"><a href="non-identifiability-in-mixture-models-an-example.html#cb13-9" tabindex="-1"></a>constrained_alpha_slices <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.6</span>, <span class="fl">0.65</span>, <span class="fl">0.75</span>)</span>
<span id="cb13-10"><a href="non-identifiability-in-mixture-models-an-example.html#cb13-10" tabindex="-1"></a>constrained_ll_data <span class="ot">&lt;-</span> constrained_space <span class="sc">%&gt;%</span> </span>
<span id="cb13-11"><a href="non-identifiability-in-mixture-models-an-example.html#cb13-11" tabindex="-1"></a>  <span class="fu">filter</span>(alpha <span class="sc">%in%</span> constrained_alpha_slices)</span>
<span id="cb13-12"><a href="non-identifiability-in-mixture-models-an-example.html#cb13-12" tabindex="-1"></a></span>
<span id="cb13-13"><a href="non-identifiability-in-mixture-models-an-example.html#cb13-13" tabindex="-1"></a><span class="co"># Find a suitable minimum for the constrained likelihood scale</span></span>
<span id="cb13-14"><a href="non-identifiability-in-mixture-models-an-example.html#cb13-14" tabindex="-1"></a>min_constrained_ll <span class="ot">&lt;-</span> <span class="fu">quantile</span>(constrained_ll_data<span class="sc">$</span>rel_likelihood, <span class="fl">0.1</span>)</span>
<span id="cb13-15"><a href="non-identifiability-in-mixture-models-an-example.html#cb13-15" tabindex="-1"></a></span>
<span id="cb13-16"><a href="non-identifiability-in-mixture-models-an-example.html#cb13-16" tabindex="-1"></a><span class="co"># Plot constrained likelihood surface</span></span>
<span id="cb13-17"><a href="non-identifiability-in-mixture-models-an-example.html#cb13-17" tabindex="-1"></a>constrained_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(constrained_ll_data, <span class="fu">aes</span>(<span class="at">x =</span> p1, <span class="at">y =</span> p2, <span class="at">fill =</span> rel_likelihood)) <span class="sc">+</span></span>
<span id="cb13-18"><a href="non-identifiability-in-mixture-models-an-example.html#cb13-18" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb13-19"><a href="non-identifiability-in-mixture-models-an-example.html#cb13-19" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>alpha, <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">alpha =</span> <span class="cf">function</span>(x) <span class="fu">paste</span>(<span class="st">&quot;α =&quot;</span>, x))) <span class="sc">+</span></span>
<span id="cb13-20"><a href="non-identifiability-in-mixture-models-an-example.html#cb13-20" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">&quot;white&quot;</span>, <span class="at">high =</span> <span class="st">&quot;darkblue&quot;</span>, </span>
<span id="cb13-21"><a href="non-identifiability-in-mixture-models-an-example.html#cb13-21" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(min_constrained_ll, <span class="dv">0</span>), </span>
<span id="cb13-22"><a href="non-identifiability-in-mixture-models-an-example.html#cb13-22" tabindex="-1"></a>                     <span class="at">oob =</span> scales<span class="sc">::</span>squish) <span class="sc">+</span></span>
<span id="cb13-23"><a href="non-identifiability-in-mixture-models-an-example.html#cb13-23" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fl">0.15</span>, <span class="at">y =</span> <span class="fl">0.85</span>, </span>
<span id="cb13-24"><a href="non-identifiability-in-mixture-models-an-example.html#cb13-24" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;Reference:&quot;</span>, fixed_alpha, fixed_p1, fixed_p2), </span>
<span id="cb13-25"><a href="non-identifiability-in-mixture-models-an-example.html#cb13-25" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb13-26"><a href="non-identifiability-in-mixture-models-an-example.html#cb13-26" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb13-27"><a href="non-identifiability-in-mixture-models-an-example.html#cb13-27" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Constrained Log-Likelihood Surface&quot;</span>,</span>
<span id="cb13-28"><a href="non-identifiability-in-mixture-models-an-example.html#cb13-28" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Adding constraints (p₁ &lt; p₂, α &gt; 0.5) reduces parameter uncertainty&quot;</span>,</span>
<span id="cb13-29"><a href="non-identifiability-in-mixture-models-an-example.html#cb13-29" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;p₁&quot;</span>,</span>
<span id="cb13-30"><a href="non-identifiability-in-mixture-models-an-example.html#cb13-30" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;p₂&quot;</span>,</span>
<span id="cb13-31"><a href="non-identifiability-in-mixture-models-an-example.html#cb13-31" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;Relative</span><span class="sc">\n</span><span class="st">Log-Likelihood&quot;</span></span>
<span id="cb13-32"><a href="non-identifiability-in-mixture-models-an-example.html#cb13-32" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb13-33"><a href="non-identifiability-in-mixture-models-an-example.html#cb13-33" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb13-34"><a href="non-identifiability-in-mixture-models-an-example.html#cb13-34" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb13-35"><a href="non-identifiability-in-mixture-models-an-example.html#cb13-35" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb13-36"><a href="non-identifiability-in-mixture-models-an-example.html#cb13-36" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb13-37"><a href="non-identifiability-in-mixture-models-an-example.html#cb13-37" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>)</span>
<span id="cb13-38"><a href="non-identifiability-in-mixture-models-an-example.html#cb13-38" tabindex="-1"></a>  )</span>
<span id="cb13-39"><a href="non-identifiability-in-mixture-models-an-example.html#cb13-39" tabindex="-1"></a></span>
<span id="cb13-40"><a href="non-identifiability-in-mixture-models-an-example.html#cb13-40" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb13-41"><a href="non-identifiability-in-mixture-models-an-example.html#cb13-41" tabindex="-1"></a>constrained_plot</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-10-1.png" width="1200" style="display: block; margin: auto;" /></p>
</div>
<div id="conclusion" class="section level2 hasAnchor" number="6.12">
<h2><span class="header-section-number">6.12</span> Conclusion<a href="non-identifiability-in-mixture-models-an-example.html#conclusion" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This tutorial has demonstrated the concept of non-identifiability in mixture models, specifically using a mixture of two binomial distributions. We have shown that:</p>
<ol style="list-style-type: decimal">
<li>Different parameter combinations can produce nearly identical probability distributions.</li>
<li>The degree of non-identifiability depends on the separation between mixture components.</li>
<li>The likelihood surface often shows ridges rather than clear peaks, reflecting parameter redundancy.</li>
<li>Adding constraints can help reduce but not eliminate the problem.</li>
</ol>
<p>When working with mixture models, it’s important to be aware of potential non-identifiability issues and interpret parameter estimates with appropriate caution. In many cases, the focus should be on the overall distribution and model predictions rather than specific parameter values.</p>
<p>Understanding non-identifiability is crucial for proper statistical inference, experimental design, and interpretation of results in many areas of science and engineering where mixture models are commonly used.</p>
<p>This completes the R Markdown file with a thorough exploration of non-identifiability in binomial mixture models, including the previously missing section on how separation between components affects identifiability.</p>
<p>The document includes:
1. Clear explanation of non-identifiability
2. Visualizations of similarly distributed mixtures with different parameters
3. Analysis of how component separation affects identifiability
4. Examination of non-identifiability regions in parameter space
5. Visualization of the likelihood surface
6. Discussion of practical implications and potential solutions</p>
<p>The code provides interactive simulations and visualizations that clearly demonstrate how different parameter combinations can lead to nearly identical observed distributions, making it challenging to recover the true parameters from data.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="labs-and-challenges.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="intervention.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
